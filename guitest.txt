--@name
--@author Ranthos
--@client
--@include brix/client/gui.lua

if player() ~= owner() then return end

require("brix/client/gui.lua")


local divRTName = "rtTest"
local RT = gui.Create("DividedRTControl")
RT.RTName = divRTName
RT:SetDivisionSize(64, 128)
RT:SetSize(64, 128)


local m = material.createFromImage("avatar_hd.png", "")

local pane = gui.Create("Control", RT)
function pane:Paint(w, h)

    render.setRGBA(math.random(0, 255), math.random(0, 255), math.random(0, 255), 255)
    render.setMaterial(m)
    render.drawTexturedRect(0, 0, w, h)

end

pane:SetSize(64, 128)


hook.add("postdrawhud", "", function()
    
    if not first then
        first = true
        render.createRenderTarget(divRTName)
        render.selectRenderTarget(divRTName)
        render.clear(Color(0, 0, 0, 0), true)
        render.selectRenderTarget()
    end

    RT.division = math.floor(timer.realtime() % RT.divisionCount) + 1
        RT.invalid = true

    gui.Draw()
    
    render.setRGBA(255, 255, 255, 255)
    render.setRenderTargetTexture(divRTName)
    render.drawTexturedRect(700, 0, 512, 512)

end)
